################################
#                              #
# Star Package Manager Library #
#                              #
################################
# Created by AwlsomeAlex [GPLv3]
# Compatible with StarOS & Star Library

SPML_VER="GIT"

# Download a File [-s will silently download]
download() {
	FILE=$1
	TICKER=$2
	if [[ $FILE == "StarOS" ]]; then
		wget https://github.com/AwlsomeAlex/StarLinux/archive/StarOS.zip -q --show-progress
	else
		if [[ $TICKER == "-s" ]]; then
			wget $FILE -q
		else
			wget $FILE -q --show-progress
		fi
	fi
}

# Install a Required Program to Host System
install_required() {
	PACKAGE=$1
	check_distro
	if [[ $OS == "Ubuntu" ]]; then
		sudo apt install $PACKAGE
	else
		echo "Unknown or Unsupported Distribution detected. Please report for support and install the package $PACKAGE manually."
	fi
}

# Title for Star Package Manager 
title() {
	clear
	echo "========================"
	echo "|                      |"
	echo "| Star Package Manager |"
	echo "|----------------------|"
	echo "|    By AwlsomeAlex    |"
	echo "|      GNU GPLv3*      |"
	echo "========================"
	echo " Version: $SPM_VER "
	echo " Function: $FUNCTION "
	echo ""	
}

check_distro() {
	if [ -f /etc/os-release ]; then
		. /etc/os-release
		OS=$NAME
	elif type lsb_release >/dev/null 2>&1; then
		OS=$(lsb_release -si)
	elif [ -f /etc/lsb_release ]; then
		. /etc/lsb_release
		OS=$DISTRIB_ID
	elif [ -f /etc/debian_version ]; then
		OS=Debian
	elif [ -f /etc/SuSe-release ]; then
		OS=Suse
	elif [ -f /etc/redhat-release ]; then
		OS=Redhat
	else
		OS=$(uname -s)
	fi
}

assurance() {
	echo "-----------------------------------------------"
	echo " Star Package Manager Library $SPML_VER Loaded."
	echo "-----------------------------------------------"
}

update_repo() {
	if [[ $NATIVE == "True" ]]; then
		ORIGIN=$(pwd)
		cd /tmp
		download https://raw.githubusercontent.com/AwlsomeAlex/StarLinux/StarOS/spm/version.txt
		diff /etc/spm/version.txt /tmp/version.txt >/dev/null 2>&1 || UPDATE=Y
		if [[ $UPDATE == "Y" ]]; then
			download ### REPO FILES ##
			### UPDATE REPO ###
		fi
		rm -rf version.txt
		cd $ORIGIN
	else
		download ### REPO FILES ###
		### SETUP REPO ###
	fi
}
